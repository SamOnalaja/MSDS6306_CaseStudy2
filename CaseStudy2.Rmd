---
title: "CaseStudy2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(caret)
library(leaps)
library(MASS)
library(DAAG)
library(bestglm)
```

```{r import, message=FALSE}
dataset <- read_csv("CaseStudy2-data.csv",
                    col_types = cols(EmployeeCount = col_skip(), ID = col_skip(), Over18 = col_skip(), Rand = col_skip(), StandardHours = col_skip()))
```

```{r set to binary and change to integer}
#maybe do this
dataset$Attrition[dataset$Attrition=="Yes"] <- 1
dataset$Attrition[dataset$Attrition=="No"] <- 0
dataset$Attrition <- as.integer(dataset$Attrition)
```

```{r convert character columns to factors}
dataset[sapply(dataset, is.character)] <- lapply(dataset[sapply(dataset, is.character)], as.factor)
```

```{r AIC model}
#this did pretty bad, R2 values of 0.25
model_aic <- lm(Attrition ~ ., data = dataset)
step.model_both <- stepAIC(model_aic, direction = "both", trace = FALSE)
step.model_forward <- stepAIC(model_aic, direction = "forward", trace = FALSE)
step.model_backward <- stepAIC(model_aic, direction = "backward", trace = FALSE)
aic_both <- summary(step.model_both)
aic_forward <- summary(step.model_forward)
aic_backward <- summary(step.model_backward)
aic_both$adj.r.squared
aic_forward$adj.r.squared
aic_backward$adj.r.squared
```

```{r ugh}
summary(model_aic)
step.model_both$anova
```

```{r ugh2}
pleaseWork <- bestglm(dataset, IC="AIC")
```

